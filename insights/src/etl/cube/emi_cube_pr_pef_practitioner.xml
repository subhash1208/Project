<cubes>
	<cube>
		<name>emi_cube_pr_pef_practitioner</name>

		<dimensions>
		    <dimension mandatory="true">environment</dimension>
			<dimension mandatory="true">clnt_obj_id</dimension>
			<hierarchy>
				<dimension mandatory="true">yr_cd</dimension>
				<dimension>qtr_cd</dimension>
				<dimension>mnth_cd</dimension>
			</hierarchy>
			<hierarchy>
				<dimension>d_work_cntry_cd</dimension>
				<dimension xor-group-name="main">d_work_state_cd</dimension>
				<dimension>d_work_loc_cd</dimension>
			</hierarchy>
			<dimension xor-group-name="main">d_job_cd</dimension>
			<!--dimension xor-group-name="main">d_gndr_cd</dimension-->
			<dimension xor-group-name="main">d_hr_orgn_id</dimension>
		</dimensions>

		<addons>
			<supportcolumns>
				<column>d_ot_ind</column>
			</supportcolumns>
		</addons>

		<facts>

			<fact>
				<!-- This fact is used ONLY for the purpose of scoring, and hence an approximation is OK -->
				<name>num_employees</name>
				<column>pers_obj_id</column>
				<aggregation>
					<type>COUNT_DISTINCT</type>
				</aggregation>
			</fact>

			<fact>
				<name>count_distinct_person</name>
				<column>pers_obj_id</column>
				<aggregation>
					<type>COUNT_DISTINCT</type>
				</aggregation>
			</fact>

			<fact>
				<name>overtime_earnings</name>
				<column>earn_amt</column>
				<when>d_ot_ind = 1</when>
				<aggregation>
					<type>SUM</type>
				</aggregation>
			</fact>

			<fact>
				<name>total_earnings</name>
				<column>earn_amt</column>
				<aggregation>
					<type>SUM</type>
				</aggregation>
			</fact>

			<!--fact>
				<name>total_hours</name>
				<column>hrs_nbr</column>
				<aggregation>
					<type>SUM</type>
				</aggregation>
			</fact-->

			<!--Overtime earnings event source count-->
			<fact>
				<name>overtime_earnings_evnt_src_cnt</name>
				<column>pers_obj_id</column>
				<when>d_ot_ind = 1</when>
				<aggregation>
					<type>COUNT_DISTINCT</type>
				</aggregation>
			</fact>

		</facts>
	</cube>
</cubes>