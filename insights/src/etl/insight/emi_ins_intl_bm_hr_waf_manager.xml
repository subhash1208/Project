<?xml version="1.0" encoding="UTF-8"?>
<insights>

	<name>emi_ins_intl_bm_hr_waf_manager</name>
	<table dbname="{{__BLUE_MAIN_DB__}}" tablename="emi_ins_intl_bm_hr_waf_manager" />
	<type>CLIENT_INTERNAL_BM</type>
	<score_expression> <![CDATA[
		ROUND(
			CASE
				WHEN ABS(zscore_norm_diff_[fact]) > 1 OR ABS(zscore_norm_pctg_diff_[fact]) > 1
				THEN GREATEST(ABS(zscore_norm_diff_[fact]) , ABS(zscore_norm_pctg_diff_[fact]))  * 1/num_dimensions
				WHEN ABS(zscore_diff_[fact]) > 3 OR ABS(zscore_pctg_diff_[fact]) > 1
				THEN GREATEST(ABS(zscore_diff_[fact])/3, ABS(zscore_pctg_diff_[fact])) * 1/num_dimensions
				ELSE
					GREATEST(
						ABS(zscore_norm_diff_[fact]),
						ABS(zscore_norm_pctg_diff_[fact]),
						ABS(zscore_diff_[fact]/3),
						ABS(zscore_pctg_diff_[fact])
					) * 1/num_dimensions
			END
		, 2 )
	]]></score_expression>

	<dimensions>
		<dimension type="invariant" partition_column="true">clnt_obj_id</dimension>
		<!--dimension type="invariant" partition_column="true">db_schema</dimension-->
		<hierarchy>
			<dimension type="invariant" partition_column="true">yr_seq_nbr</dimension>
			<dimension type="invariant" partition_column="true">qtr_seq_nbr</dimension>
			<dimension type="invariant" partition_column="true">mnth_seq_nbr</dimension>
		</hierarchy>
	</dimensions>

	<zscore_filter>(tot_rpt_headcount &gt;= 1000 and percentage_headcount &gt;= 3) or (tot_rpt_headcount &gt;= 100 and tot_rpt_headcount &lt;= 1000 and percentage_headcount &gt;= 5)
     or (tot_rpt_headcount &gt;= 10 and tot_rpt_headcount &lt;= 100 and num_employees &gt;= 5) or (tot_rpt_headcount &lt; 10 and num_employees &gt;= 3)</zscore_filter>
		
	<facts>
		<fact>
			<name>turnover_rate</name>
			<name>voln_turnover_rate</name>
			<name>internal_mobility_rate</name>
			<!--name>female_percentage</name-->
			<name>newhire_turnover_rate</name>
			<name>average_tenure</name>
			<!--name>span_of_control</name>
			<name>compa_ratio</name-->
			<name>avg_time_to_promotion</name>
			<name>retention_rate</name>
			<name>leave_percentage</name>
			<name type="non-rate">num_hires</name>
			<name type="non-rate">num_terminations</name>
			<name type="non-rate">headcount</name>
			<!--name type="non-rate">inactive_headcount</name>
			<name type="non-rate">parttime_headcount</name>
			<name type="non-rate">temp_headcount</name-->
		</fact>
	</facts>

	<supportcolumns>
		<column>environment</column>
	    <column>num_employees</column>
	    <column>d_job_cd</column>
		<column>d_hr_orgn_id</column>
		<!--column>d_gndr_cd</column-->
		<column>mngr_pers_obj_id</column>
		<column>d_work_cntry_cd</column>
		<column>d_work_state_cd</column>
		<!--column>d_work_city_cd</column-->
		<column>d_work_loc_cd</column>
		<column>headcount</column>
		<column>tot_rpt_headcount</column>
		<column>percentage_headcount</column>
		<column>turnover_rate_events</column>
		<column>voln_turnover_rate_events</column>
		<column>newhire_turnover_rate_events</column>
		<column>internal_mobility_rate_events</column>
		<column>average_tenure_events</column>
		<column>avg_time_to_promotion_events</column>
		<column>retention_rate_events</column>
		<column>leave_percentage_events</column>
		<column>headcount_events</column>
		<column>num_hires_events</column>
		<column>num_terminations_events</column>
		<!--column>retn_period_strt_person_cnt</column>
		<column>retn_period_end_person_cnt</column-->
		<column>period_cd</column>
	</supportcolumns>

<analysisgroups>
		<analysisgroup>
			<name>clnt_obj_id</name>
			<name>yr_seq_nbr</name>
			<name>qtr_seq_nbr</name>
			<name>mnth_seq_nbr</name>
		</analysisgroup>
</analysisgroups>

</insights>